<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <title>Hello, world!</title>
  </head>
  <body>
    <nav class="navbar navbar-light" style="background-color: #ff8000;">
      <i class="fa fa-bars text-light" aria-hidden="true"></i>
      <h5 class="font-weight-bold text-light" style="margin-right: 90px;">Početna strana</h5>
      <i class="fa fa-bell-o text-light" aria-hidden="true"></i>

    </nav>

    <div class="row mt-4">
      <div class="col-1"></div>
      <div class="col-2">
        <div class="rounded-circle" style="width: 75px; height: 75px; background-color: #bfbfbf; display: flex; justify-content: center; align-items: center;">
          <h3>MČ</h3>
        </div>
      </div>
      <div class="col-1"></div>
      <div class="col-7">
        <h5>Dobro došli,</h5>
        <h5 class="font-weight-bold">MILUTIN ČAPRIĆ</h5>
      </div>
      <div class="col-1"></div>
    </div>

    <div class="row mt-4">
      <div class="col-1"></div>
      <div class="col-10 rounded" style="box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;border-top: 7px solid #ff8000;">

        <div class="row mt-3">
          <div class="col-10">
            <p class="text-secondary">160600000146916055</p>
          </div>
          <div class="col-2 text-right">
            <i class="fa fa-ellipsis-v text-secondary" aria-hidden="true"></i>
          </div>
        </div>

        <div class="row">
          <div class="col-10 pb-2">
            <h3 class="" id="main_ammount"></h3>
            <p class="text-secondary" style="font-size: 10px;">Ukupno raspoloživo stanje</p>
          </div>
          <div class="col-2 d-flex align-items-center">
            <div class="rounded-circle mb-3" style="width: 25px; height: 25px; background-color: #ffcc99; display: flex; justify-content: center; align-items: center;">
            <i class="fa fa-eye" style="color: #ff8000;" aria-hidden="true"></i>
          </div>
          </div>
        </div>

        <div class="d-flex">
          <div class="">
            <i class="fa fa-database text-secondary" aria-hidden="true"></i>


          </div>
          <div class="ml-3">
            <p style="margin-bottom: 0;" class="font-weight-bold">Stanje</p>
            <p class="text-secondary" id="secondary_ammount"></p>
          </div>
        </div>

        <div class="d-flex">
          <div class="">
            <i class="fa fa-database text-secondary" aria-hidden="true"></i>


          </div>
          <div class="ml-3">
            <p style="margin-bottom: 0;" class="font-weight-bold">Preostali iznos dozvoljenog prekoračenja</p>
            <p style="margin-bottom: 0;" class="text-secondary">0.00 USD</p>
            <p  class="text-secondary" style="font-size: 12px;">Odobren iznos dozvoljenog prekoračenja: 0.00 USD</p>
          </div>
        </div>

        <hr style="margin-top: 5px; margin-bottom: 5px;">


        <div class="d-flex">
          <div class="">
            <i class="fa fa-lock text-secondary" aria-hidden="true"></i>

          </div>
          <div class="ml-3">
            <p style="margin-bottom: 0;" class="font-weight-bold">Rezervisana sredstva</p>
            <p class="text-secondary">0.00 USD</p>
          </div>
        </div>

      </div>
      <div class="col-1"></div>
    </div>

    <div class="row mt-4 mb-5">
      <div class="col-2 d-flex justify-content-center align-items-center" style="padding: 0;">
        <i class="fa fa-exchange text-secondary ml-3" aria-hidden="true" style="font-size: 24px;"></i>

      </div>
      <div class="col-10">
        <h3 class="font-weight-bold">Transakcije</h3>
      </div>
    </div>

    

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

    <script type="text/javascript">
      // Starting amount and date
let startingAmount = 631184.54;
let startingDate = new Date(2023, 6, 3); // Note: JavaScript months are zero-based, so July is represented by 6

// Array to store transactions
let transactions = [];

// Function to calculate the transaction amount based on the given date
function calculateTransactionAmount(date) {
  let day = date.getDate();
  let month = date.toLocaleString('sr-RS', { month: 'long' }).toUpperCase();
  let transaction = {};

  if (day === 5) {
    transaction = {
      date_number: day < 10 ? `0${day}` : day,
      month: month,
      added_or_reduced: 'added',
      amount: '1.179,00',
      p1: 'UPLATA/ISPLATA',
      p2: 'Priliv iz inostranstva 1/FEDERAL RESERVE BANK OF NY'
    };
    startingAmount += 1179;
  } else if (day === 31 || (day === 30 && [3, 5, 8, 10].includes(date.getMonth()))) {
    transaction = {
      date_number: day < 10 ? `0${day}` : day,
      month: month,
      added_or_reduced: 'reduced',
      amount: '0,77',
      p1: 'NAKNADA',
      p2: 'Naknada za mesečno održavanje računa'
    };
    startingAmount -= 0.77;
  }

  if (Object.keys(transaction).length !== 0) {
    transactions.push(transaction);
  }
}

// Function to format the amount with dot separators and a comma as the last separator
function formatAmount(amount) {
  let [wholePart, decimalPart] = amount.toFixed(2).split('.');
  let formattedAmount = wholePart.replace(/\B(?=(\d{3})+(?!\d))/g, '.');
  formattedAmount += ',' + decimalPart;
  return formattedAmount;
}

// Function to calculate the transactions and final amount
function calculateTransactions() {
  let currentDate = new Date();
  let dateDiff = Math.ceil((currentDate - startingDate) / (1000 * 60 * 60 * 24));

  for (let i = 1; i <= dateDiff; i++) {
    let date = new Date(startingDate.getTime() + i * (1000 * 60 * 60 * 24));
    calculateTransactionAmount(date);
  }

  // Display the list of transactions
  console.log(transactions);

  // Display the final amount
  console.log('Final Amount:', formatAmount(startingAmount));

  if (transactions.length === 1) {
  transactions.push(
    {
      date_number: '30',
      month: 'JUN',
      added_or_reduced: 'reduced',
      amount: '0,77',
      p1: 'NAKNADA',
      p2: 'Naknada za mesečno održavanje računa'
    },
    {
      date_number: '05',
      month: 'JUN',
      added_or_reduced: 'added',
      amount: '1.179,00',
      p1: 'UPLATA/ISPLATA',
      p2: 'Priliv iz inostranstva 1/FEDERAL RESERVE BANK OF NY'
    },
    {
      date_number: '31',
      month: 'MAJ',
      added_or_reduced: 'reduced',
      amount: '0,77',
      p1: 'NAKNADA',
      p2: 'Naknada za mesečno održavanje računa'
    }
  );
} else if (transactions.length === 2) {
  transactions.push(
    {
      date_number: '30',
      month: 'JUN',
      added_or_reduced: 'reduced',
      amount: '0,77',
      p1: 'NAKNADA',
      p2: 'Naknada za mesečno održavanje računa'
    },
    {
      date_number: '05',
      month: 'JUN',
      added_or_reduced: 'added',
      amount: '1.179,00',
      p1: 'UPLATA/ISPLATA',
      p2: 'Priliv iz inostranstva 1/FEDERAL RESERVE BANK OF NY'
    }
  );
} else if (transactions.length === 3) {
  transactions.push(
    {
      date_number: '30',
      month: 'JUN',
      added_or_reduced: 'reduced',
      amount: '0,77',
      p1: 'NAKNADA',
      p2: 'Naknada za mesečno održavanje računa'
    }
  );
}

transactions.reverse()
createHTML()
}

function createHTML(){
  document.getElementById('main_ammount').innerHTML = `${formatAmount(startingAmount)} <span style="font-size: 15px;">USD</span>`

  document.getElementById('secondary_ammount').innerHTML = `${formatAmount(startingAmount)} <span>USD</span>`

  transactions.forEach(i => {
    let div = document.createElement('div')
    div.classList.add('row')
    div.innerHTML = 
      `
        <div class="col-3 d-flex flex-column justify-content-center align-items-center">
        <h5 style="margin-bottom: 0;" class="font-weight-bold" style="margin-bottom: 0;">${i.date_number}</h5>
        <h5 class="font-weight-bold">${i.month}</h5>
      </div>
      <div class="col-9">
        <p class="text-secondary" style="margin-bottom: 0;">${i.p1}</p>
        <p class="text-secondary" style="margin-bottom: 0;">${i.p2}</p>
        <h4 class="${i.added_or_reduced == 'added' ? 'text-success' : ''} font-weight-bold">${i.added_or_reduced == 'added' ? '+' : '-'}${i.amount} USD</h4>
      </div>
      <hr style="margin-top: 5px; margin-bottom: 5px;">
      `  
      document.getElementsByTagName('BODY')[0].appendChild(div)
  })
}



// Call the function to calculate transactions
calculateTransactions();

    </script>

  </body>
</html>
